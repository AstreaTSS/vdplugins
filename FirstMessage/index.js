(function(f,$,h,B){"use strict";var N;(function(e){e[e.BUILT_IN=0]="BUILT_IN",e[e.BUILT_IN_TEXT=1]="BUILT_IN_TEXT",e[e.BUILT_IN_INTEGRATION=2]="BUILT_IN_INTEGRATION",e[e.BOT=3]="BOT",e[e.PLACEHOLDER=4]="PLACEHOLDER"})(N||(N={}));var c;(function(e){e[e.SUB_COMMAND=1]="SUB_COMMAND",e[e.SUB_COMMAND_GROUP=2]="SUB_COMMAND_GROUP",e[e.STRING=3]="STRING",e[e.INTEGER=4]="INTEGER",e[e.BOOLEAN=5]="BOOLEAN",e[e.USER=6]="USER",e[e.CHANNEL=7]="CHANNEL",e[e.ROLE=8]="ROLE",e[e.MENTIONABLE=9]="MENTIONABLE",e[e.NUMBER=10]="NUMBER",e[e.ATTACHMENT=11]="ATTACHMENT"})(c||(c={}));var g;(function(e){e[e.CHAT=1]="CHAT",e[e.USER=2]="USER",e[e.MESSAGE=3]="MESSAGE"})(g||(g={}));const{sendBotMessage:_}=h.findByProps("sendBotMessage"),y=h.findByProps("getAPIBaseURL","get");let A=[];const L=function(){A.push($.registerCommand({name:"firstmessage",displayName:"firstmessage",description:"Tired of scrolling to first message?",displayDescription:"Tired of scrolling to first message?",type:g.CHAT,inputType:N.BUILT_IN_TEXT,applicationId:"-1",options:[{name:"user",displayName:"user",description:"Target user to get their first message in this server/dm",displayDescription:"Target user to get their first message in this server/dm",type:c.USER,required:!1},{name:"channel",displayName:"channel",description:"Target channel to get first message of",displayDescription:"Target channel to get first message of",type:c.CHANNEL,required:!1},{name:"send",displayName:"send",description:"Whether to send the resulting url",displayDescription:"Whether to send the resulting url",type:c.BOOLEAN,required:!1}],async execute(e,t){var i,o,l,u;const m=(i=e.find(function(n){return n.name==="user"}))===null||i===void 0?void 0:i.value,r=(o=e.find(function(n){return n.name==="channel"}))===null||o===void 0?void 0:o.value,U=(l=e.find(function(n){return n.name==="send"}))===null||l===void 0?void 0:l.value,s=(u=t.guild)===null||u===void 0?void 0:u.id,d=t.channel.id,p=t.channel.type===1;let a="https://discord.com/channels/";if(!m&&!r)if(p){const n=await I(d);a+=`@me/${d}/${n.id}`}else{const n=await T(s);a+=`${s}/${n.channel_id}/${n.id}`}else if(m)if(p){const n=await I(d,m);a+=`@me/${d}/${n.id}`}else{const n=await T(s,m);a+=`${s}/${n.channel_id}/${n.id}`}else if(r){if(p)return _(d,"This combination cannot be used in dms!");const n=await T(s,null,r);a+=`${s}/${r}/${n.id}`}else{if(p)return _(d,"This combination cannot be used in dms!");const n=await T(s,m,r);a+=`${s}/${r}/${n.id}`}return U?{content:a}:B.url.openDeeplink(a)}}))},O=function(){for(const e of A)e()},T=async function(e,t,i){const o=t?`&author_id=${t}`:"",l=i?`&channel_id=${i}`:"",u=t?"":"&min_id=0";return(await y.get({url:`/guilds/${e}/messages/search`,query:`include_nsfw=true${o}${l}${u}&sort_by=timestamp&sort_order=asc&offset=0`})).body.messages[0][0]},I=async function(e,t){const i=t?`&author_id=${t}`:"",o=t?"":"&min_id=0";return(await y.get({url:`/channels/${e}/messages/search`,query:`&sort_by=timestamp&sort_order=asc&offset=0${i}${o}`})).body.messages[0][0]};return f.onLoad=L,f.onUnload=O,f})({},vendetta.commands,vendetta.metro,vendetta.metro.common);
